#!/usr/bin/env python
# Primeira coisa: perguntar para whois.iana.org a onde pesquisa aquele dominio
# A resposta vem no "refer: ..." -> Depois armazenar em uma variavel 
import socket, sys

def titulo():
    print("="*20+"|> WHOIS <|"+"="*20)

def linha():
    print("-" * 51)

if (len(sys.argv) <= 1):
    titulo()
    print("=> Modo de uso\n=> ./whois.py [SITE/DOMINIO]\n")
    linha()

else:    
    titulo()
    # Estabelecer conexao
    meuSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    meuSocket.connect(("whois.iana.org", 43))

    # Enviando Query
    meuSocket.send(sys.argv[1]+"\r\n")

    # Resposta do servidor
    resposta = meuSocket.recv(1024).split()
    whois = resposta[19] 

    # Fazendo pesquisa no Whois certo
    novoSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    novoSocket.connect((whois, 43))
    novoSocket.send(sys.argv[1]+"\r\n")

    respostaCerta = novoSocket.recv(1024)

    print(respostaCerta)

    linha()

print("\033[1;31m***>---------------------<***")
print("\033[1;32m***>-<  By: Felipesco  >-<***")
print("\033[1;31m***>---------------------<***")

exit()