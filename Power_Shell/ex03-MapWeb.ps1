param($site)

if(!$site){
    echo ">>>> MAP WEB <<<<"
    echo "Modo de uso: .\ex03-MapWeb.ps1 [SITE]"

} else {
    echo " "
    try {
        echo "________________SERVIDOR________________"
 
        $servidor = Invoke-WebRequest -uri "$site" -Method Options

        echo "Código de retorno: $($servidor.statusCode) $($servidor.statusDescription)" 
        echo "O servidor roda: $($servidor.headers.server)"
        echo "Metodos aceitos: $($servidor.headers.allow)"
    } catch{}

    echo " "
    echo "___________LINKS_ENCONTRADOS____________"
    $link = Invoke-WebRequest -uri "$site"
    $link.links.href | Select-String http://
    
}